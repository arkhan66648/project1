<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>StreamEast - Live Sports</title>
    <meta name="description" content="The #1 Source for live sports.">
    <meta name="theme-color" content="#D00000">
    <link rel="canonical" href="https://StreamEast Live/">
    <link rel="icon" href="">

    <!-- 1. DYNAMIC SCHEMAS (Injected by Python ONLY on Home) -->
    

    <style>
        :root {
            --brand-primary: #D00000;
            --brand-dark: #8a0000;
            --status-green: #00e676;
            --accent-gold: #FFD700;
            --bg-body: #050505;
            --bg-glass: rgba(18, 18, 18, 0.9);
            --border: #222;
            --text-main: #ffffff;
            --hero-grad: #1a0505;
            --font-main: system-ui, -apple-system, sans-serif;
        }

        * { box-sizing: border-box; }
        body { margin: 0; font-family: var(--font-main); background: var(--bg-body); color: var(--text-main); padding-bottom: 70px; }
        a { text-decoration: none; color: inherit; transition: 0.2s; }
        button { cursor: pointer; border: none; font-family: inherit; }

        /* HEADER */
        header { background: rgba(5,5,5,0.95); backdrop-filter: blur(10px); border-bottom: 1px solid var(--border); height: 60px; width: 100%; position: fixed; top: 0; z-index: 100; }
        .header-container { max-width: 1100px; margin: 0 auto; height: 100%; padding: 0 15px; display: flex; align-items: center; justify-content: space-between; }
        .logo-link { display: flex; align-items: center; gap: 10px; }
        .logo-img { height: 35px; border-radius: 6px; }
        .logo-text { font-size: 1.4rem; font-weight: 900; font-style: italic; letter-spacing: -1px; text-transform: uppercase; }
        .logo-text span { color: var(--brand-primary); }
        .nav-links { display: none; gap: 20px; font-weight: 600; font-size: 0.85rem; text-transform: uppercase; color: #aaa; }
        .nav-links a:hover { color: #fff; }
        .hamburger { display: block; font-size: 1.4rem; color: #fff; background: none; }
        .mobile-menu { position: fixed; top: 60px; left: 0; width: 100%; background: #0f0f0f; border-bottom: 1px solid var(--border); display: none; flex-direction: column; z-index: 99; }
        .mobile-menu.active { display: flex; }
        .mobile-menu a { padding: 15px 20px; border-bottom: 1px solid #1f1f1f; font-weight: 600; }
        @media (min-width: 900px) { .nav-links { display: flex; } .hamburger { display: none; } }

        /* HERO */
        .hero { padding: 90px 15px 15px 15px; text-align: center; background: radial-gradient(circle at top, var(--hero-grad) 0%, var(--bg-body) 80%); border-bottom: 1px solid var(--border); display: block; }
        .sys-status { display: inline-flex; align-items: center; gap: 8px; background: rgba(0,230,118,0.08); border: 1px solid rgba(0,230,118,0.2); padding: 5px 14px; border-radius: 20px; margin-bottom: 15px; font-size: 0.75rem; font-weight: 700; color: var(--status-green); }
        .dot { width: 6px; height: 6px; background: var(--status-green); border-radius: 50%; box-shadow: 0 0 8px var(--status-green); animation: pulse 2s infinite; }
        h1 { margin: 0 0 20px 0; font-size: 1.8rem; line-height: 1.2; font-weight: 800; }
        .entity-intro { color: #999; font-size: 0.9rem; max-width: 800px; margin: 0 auto; line-height: 1.5; }
        .cat-scroll { display: flex; gap: 10px; overflow-x: auto; padding: 15px 5px; justify-content: center; }
        .cat-pill { background: #111; border: 1px solid var(--border); padding: 8px 18px; border-radius: 50px; font-weight: 700; font-size: 0.8rem; white-space: nowrap; color: #ccc; }
        .cat-pill:hover { border-color: var(--brand-primary); color: #fff; }

        /* MATCHES */
        .container { max-width: 1000px; margin: 0 auto; padding: 20px 15px; }
        .sec-head { display: flex; justify-content: space-between; align-items: flex-end; margin: 30px 0 12px 0; padding-bottom: 8px; border-bottom: 1px solid #1a1a1a; }
        .sec-title { font-size: 1.1rem; font-weight: 800; color: #fff; display: flex; align-items: center; gap: 8px; text-transform: uppercase; }
        .live-dot { width: 8px; height: 8px; background: var(--brand-primary); border-radius: 50%; box-shadow: 0 0 10px var(--brand-primary); }
        .sec-right-link { font-size: 0.8rem; font-weight: 600; color: #888; cursor: pointer; }
        
        .match-row { display: grid; grid-template-columns: 50px 1fr 70px 70px; align-items: center; gap: 10px; background: var(--bg-glass); border: 1px solid var(--border); border-radius: 6px; padding: 10px; margin-bottom: 8px; transition: 0.2s; }
        .match-row:hover { border-color: #444; transform: translateY(-2px); background: #222; }
        .match-row.live { border-left: 3px solid var(--brand-primary); background: linear-gradient(90deg, rgba(208,0,0,0.06) 0%, rgba(20,20,20,0.8) 100%); }
        
        .col-time { text-align: center; display: flex; flex-direction: column; justify-content: center; gap: 2px; }
        .time-main { font-size: 0.75rem; font-weight: 700; color: #fff; }
        .time-sub { font-size: 0.6rem; color: #888; }
        .live-txt { color: var(--brand-primary); font-weight: 900; animation: blink 1.5s infinite; font-size: 0.65rem; }
        
        .col-info { display: flex; flex-direction: column; gap: 3px; min-width: 0; justify-content: center; }
        .league-tag { font-size: 0.6rem; color: #666; font-weight: 700; text-transform: uppercase; }
        .team-name { font-size: 0.9rem; font-weight: 600; color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: flex; align-items: center; gap: 6px; }
        
        .col-meta { display: flex; flex-direction: column; align-items: flex-end; gap: 3px; justify-content: center; }
        .meta-top { font-size: 0.7rem; font-weight: 700; color: var(--accent-gold); }
        .meta-bot { font-size: 0.6rem; color: #aaa; border: 1px solid #333; padding: 1px 4px; border-radius: 3px; }
        
        .btn-watch { background: var(--brand-primary); color: #fff; font-size: 0.65rem; font-weight: 800; padding: 8px 10px; border-radius: 4px; width: 100%; text-transform: uppercase; }
        .btn-watch:hover { filter: brightness(1.1); }
        
        @media (min-width: 768px) {
            .match-row { grid-template-columns: 80px 1fr 100px 100px; padding: 15px 20px; gap: 20px; }
            .team-name { font-size: 1rem; }
            .btn-watch { font-size: 0.8rem; padding: 10px 0; }
        }

        .show-more-btn { display: block; margin: 20px auto; background: #151515; border: 1px solid #333; color: #ccc; padding: 12px 25px; border-radius: 30px; font-weight: 600; font-size: 0.85rem; }
        
        /* Modal & Footer */
        .seo-box { background: #0a0a0a; border: 1px solid var(--border); padding: 25px; border-radius: 10px; margin-top: 40px; color: #ccc; }
        footer { text-align: center; padding: 40px 20px; color: #444; font-size: 0.75rem; }
        
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 2000; display: none; justify-content: center; align-items: center; }
        .modal-box { background: #1a1a1a; width: 90%; max-width: 600px; border: 1px solid #333; border-radius: 8px; overflow: hidden; display: flex; flex-direction: column; max-height: 80vh; }
        .modal-head { padding: 15px; background: #111; display: flex; justify-content: space-between; border-bottom: 1px solid #333; }
        .modal-body { padding: 20px; overflow-y: auto; }
        
        @keyframes blink { 0%, 100% {opacity:1;} 50% {opacity:0.4;} }
        .t-logo { width: 18px; height: 18px; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; font-size: 9px; font-weight: bold; color: #000; }
    </style>
</head>
<body>

    <header>
        <div class="header-container">
            <a href="/" class="logo-link">
                <img src="/assets/streameast-logo-hd.jpg" class="logo-img"> <div class="logo-text">Stream<span>East</span></div>
            </a>
            <nav class="nav-links">
                <a href="#sports">Schedule</a><a href="#features">Features</a>
            </nav>
            <button class="hamburger" onclick="toggleMenu()">‚ò∞</button>
        </div>
    </header>

    <div class="mobile-menu" id="mobileMenu"><a href="#sports">Schedule</a><a href="#features">Features</a></div>

    <div class="hero">
        <div class="sys-status"><div class="dot"></div> System Status: Online</div>
        <h1>Stream - East</h1>
        <p class="entity-intro">The #1 Source for live sports.</p>
        <div class="cat-scroll"><a href="/nba/" class="cat-pill">üèÄ NBA</a><a href="/nfl/" class="cat-pill">üèà NFL</a><a href="/ufc/" class="cat-pill">ü•ä UFC</a></div>
    </div>

    <div class="container">
        <!-- 1. TRENDING LIVE SECTION -->
        <div id="live-section">
            <div class="sec-head">
                <div class="sec-title"><div class="live-dot"></div> Trending Live</div>
                <div class="sec-right-link" id="live-count">Loading...</div>
            </div>
            <div id="trending-list" class="match-list"></div>
            <button id="show-more-live" class="show-more-btn" style="display:none">Show All Live Matches ‚ñº</button>
            <div id="hidden-live-list" class="match-list" style="display:none; margin-top:10px;"></div>
        </div>

        <!-- 2. UPCOMING SECTIONS (Populated by JS) -->
        <div id="upcoming-container"></div>

        <!-- SEO Content -->
        <div class="seo-box"><h2>Welcome</h2></div>
    </div>

    <footer>&copy; 2025 StreamEast Live. All rights reserved.</footer>

    <!-- STREAM MODAL -->
    <div class="modal" id="streamModal">
        <div class="modal-box">
            <div class="modal-head">
                <span style="color:#fff; font-weight:700;" id="modalTitle">Streams</span>
                <button onclick="closeModal()" style="background:none; color:#fff; font-size:18px;">‚úï</button>
            </div>
            <div class="modal-body" id="modalList"></div>
        </div>
    </div>

    <script>
        const API_URL = "https://vercelapi-olive.vercel.app/api/sync-nodes";
        const TARGET_COUNTRY = "UK"; // Injected by Python
        
        let allMatches = [];

        window.addEventListener('DOMContentLoaded', loadMatches);

        async function loadMatches() {
            try {
                // Fetch using the Admin-selected country
                const res = await fetch(`${API_URL}?country=${TARGET_COUNTRY.toLowerCase()}`);
                const data = await res.json();
                
                allMatches = data.matches;
                document.getElementById('live-count').innerText = `‚óè ${data.total} Events`;

                renderApp(data.matches);

            } catch(e) { console.error(e); }
        }

        function renderApp(matches) {
            // 1. Separate Live vs Upcoming
            const liveMatches = matches.filter(m => m.is_live);
            const upcomingMatches = matches.filter(m => !m.is_live);

            // 2. Render Live (Top 5 + Hidden)
            renderLiveSection(liveMatches);

            // 3. Render Upcoming (Grouped by Sport)
            renderUpcomingSections(upcomingMatches);
        }

        function renderLiveSection(matches) {
            const topList = document.getElementById('trending-list');
            const hiddenList = document.getElementById('hidden-live-list');
            const btn = document.getElementById('show-more-live');
            
            topList.innerHTML = ''; hiddenList.innerHTML = '';

            if (matches.length === 0) {
                topList.innerHTML = '<div style="text-align:center; padding:20px; color:#666">No live matches right now.</div>';
                return;
            }

            // Top 5
            matches.slice(0, 5).forEach(m => topList.appendChild(createMatchRow(m)));

            // Rest
            if (matches.length > 5) {
                matches.slice(5).forEach(m => hiddenList.appendChild(createMatchRow(m)));
                btn.style.display = 'block';
                btn.innerText = `Show ${matches.length - 5} More Matches ‚ñº`;
                btn.onclick = () => {
                    hiddenList.style.display = 'block';
                    btn.style.display = 'none';
                };
            }
        }

        function renderUpcomingSections(matches) {
            const container = document.getElementById('upcoming-container');
            container.innerHTML = '';

            // Group by Sport
            const groups = {};
            matches.forEach(m => {
                // Filter: Only show matches starting within 24h
                const hoursUntil = (m.startTimeUnix - Date.now()) / 3600000;
                if (hoursUntil < 24) {
                    if (!groups[m.sport]) groups[m.sport] = [];
                    groups[m.sport].push(m);
                }
            });

            // Sort Sports by Priority (Backend score logic works, but grouping separates them)
            // We can iterate based on a fixed order or dynamic. 
            // Simple: just render available groups.
            Object.keys(groups).forEach(sport => {
                const section = document.createElement('div');
                section.className = 'sport-section';
                
                // Header with "View More" link
                const cleanSport = sport.toLowerCase().replace(/ /g, '-');
                const headerHtml = `
                    <div class="sec-head">
                        <div class="sec-title">${getSportIcon(sport)} Upcoming ${sport.toUpperCase()}</div>
                        <a href="/${cleanSport}/" class="sec-right-link">View All ></a>
                    </div>
                `;
                
                const list = document.createElement('div');
                groups[sport].forEach(m => list.appendChild(createMatchRow(m)));

                section.innerHTML = headerHtml;
                section.appendChild(list);
                container.appendChild(section);
            });
        }

        function createMatchRow(m) {
            const div = document.createElement('div');
            div.className = m.is_live ? 'match-row live' : 'match-row';
            
            // Time Column
            let timeCol = '';
            if (m.is_live) {
                timeCol = `<span class="live-txt">LIVE</span><span class="time-sub">${m.status_text}</span>`;
            } else {
                timeCol = `<span class="time-main">${m.formatted_date.split('‚Ä¢')[1] || ''}</span><span class="time-sub">${m.formatted_date.split('‚Ä¢')[0]}</span>`;
            }

            // Teams Column
            const letterA = m.team_a_letter || 'T';
            const letterB = m.team_b_letter || 'T';
            
            const teamsCol = `
                <div class="league-tag">${m.tournament}</div>
                <div class="team-name">
                    <span class="t-logo" style="background:${getColor(letterA)}">${letterA}</span> ${m.team_a}
                </div>
                <div class="team-name">
                    <span class="t-logo" style="background:${getColor(letterB)}">${letterB}</span> ${m.team_b || ''}
                </div>
            `;

            // Meta Column
            const metaCol = `
                <div class="meta-top">${m.live_viewers || ''}</div>
                <div class="meta-bot">HD</div>
            `;

            // Button Column
            const safeStreams = encodeURIComponent(JSON.stringify(m.streams));
            const btnCol = `<button class="btn-watch" onclick="openModal('${m.team_a}', '${safeStreams}')">WATCH</button>`;

            div.innerHTML = `<div class="col-time">${timeCol}</div><div class="col-info">${teamsCol}</div><div class="col-meta">${metaCol}</div><div class="col-action">${btnCol}</div>`;
            return div;
        }

        function openModal(title, json) {
            const modal = document.getElementById('streamModal');
            const list = document.getElementById('modalList');
            document.getElementById('modalTitle').innerText = title;
            list.innerHTML = '';
            
            const streams = JSON.parse(decodeURIComponent(json));
            if(!streams.length) list.innerHTML = '<p style="color:#aaa">No streams available.</p>';
            
            streams.forEach(s => {
                const el = document.createElement('div');
                el.className = 'stream-item'; // You need CSS for this class in header
                el.style.padding = '10px';
                el.style.border = '1px solid #333';
                el.style.marginBottom = '5px';
                el.style.cursor = 'pointer';
                el.style.color = '#fff';
                el.innerText = `‚ñ∂ ${s.source_name}`;
                el.onclick = () => window.open(s.url || window.atob(s.encrypted_data.split(':')[1]), '_blank');
                list.appendChild(el);
            });
            modal.style.display = 'flex';
        }

        function closeModal() { document.getElementById('streamModal').style.display = 'none'; }
        function toggleMenu() { document.getElementById('mobileMenu').classList.toggle('active'); }
        function getColor(l) { return '#ccc'; } // Simple fallback color
        function getSportIcon(s) { return 'üèÜ'; } // Simple fallback icon
    </script>
</body>
</html>
